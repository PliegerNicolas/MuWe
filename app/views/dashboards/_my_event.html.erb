<div class="my-event">
  <div class="dashboard-event-image">
    <%= link_to event_path(event.id) do %>
      <%= image_tag event.location_photo, height: '200px', width: '300px' %>
    <% end %>
  </div>
  <div class="dashboard-participants">
    <% unless event.status == 'finished' %>
      <div class="dashboard-event-info">
        <div><strong>Status : </strong><p><%= event.status.capitalize unless event.address.nil? %></p></div>
        <div><strong>Address : </strong><p><%= event.address.capitalize unless event.address.nil? %></p></div>
        <hr>
      </div>

      <strong>Postulating participants</strong>
      <div class="postulating-users">
        <% event.participants.where(status: 'postulating').each do |participant| %>
          <div class="postulating-user">
            <%= link_to profile_path(participant.user) do %>
                <%= image_tag participant.user.profile.profile_photo, height: '45px', width: '45px', crop: "scale", gravity: "faces", format: "png", secure: true %>
                <%= participant.user.full_name %>
              <% end %>
              <%= link_to "Accept", event_accept_user_path(event.id, participant.id), method: :post, class: "host-action-button" %>
              <%= link_to "Decline", event_decline_user_path(event.id, participant.id), method: :delete, class: "host-action-button" %>
          </div>
        <% end %>
      </div>

      <strong>Accepted participants</strong>
      <div class="accepted-users">
        <% event.participants.where(status: 'accepted').each do |participant| %>
          <div class="accepted-user">
            <% unless event.participants.where(user_id: event.user_id).include?(participant) %> <!-- Check if host -->
              <%= link_to profile_path(participant.user) do %> <!-- Host section -->
                <%= image_tag participant.user.profile.profile_photo, height: '45px', width: '45px', crop: "scale", gravity: "faces", format: "png", secure: true %>
                <%= participant.user.full_name %>
                <%= link_to "Decline", event_decline_user_path(event.id, participant.id), method: :delete, class: "host-action-button" %>
              <% end %>
            <% else %>
              <%= link_to profile_path(participant.user) do %> <!-- Host section -->
                <%= image_tag participant.user.profile.profile_photo, height: '45px', width: '45px', crop: "scale", gravity: "faces", format: "png", secure: true %>
                <%= participant.user.full_name %>
              <% end %>
            <% end %>
          </div>
        <% end %>
      </div>

      <strong>Declined participants</strong>
      <div class="declined-users">
        <% event.participants.where(status: 'declined').each do |participant| %>
          <div class="declined-user">
            <%= link_to profile_path(participant.user) do %>
                <%= image_tag participant.user.profile.profile_photo, height: '45px', width: '45px', crop: "scale", gravity: "faces", format: "png", secure: true %>
                <%= participant.user.full_name %>
              <% end %>
              <%= link_to "Accept", event_accept_user_path(event.id, participant.id), method: :post, class: "host-action-button" %>
          </div>
        <% end %>
      </div>

      <div class="archive-section">
        <hr>
        <%= link_to "Archive", event_path(event.id), method: :delete, data: { confirm: 'Are you sure ? It can\'t be undone' } %>
      </div>
    <% else %>
      <div class="dashboard-event-info">
        <p><strong>Status :</strong> <%= event.status %></p>
        <p><strong>Address :</strong> <%= event.address %></p>
      </div>
      <% event.participants.each do |participant| %>
        <%= link_to profile_path(participant.user.profile.id) do %>
          <%= participant.user.full_name  %>
        <% end %>
      <% end %>
    <% end %>
  </div>
</div>
